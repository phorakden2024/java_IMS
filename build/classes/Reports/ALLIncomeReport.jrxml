<!-- Created with Jaspersoft Studio version 7.0.3.final using JasperReports Library version 7.0.3-41034ca841d452f3305ba55b9042260aaa1ab5dd  -->
<jasperReport name="ProductInventoryReport" language="java" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="bea91bc8-af89-4e0d-9bb7-02284909c0dd">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="One Empty Record"/>
	<query language="sql"><![CDATA[SELECT
            pro.id AS product_id,
            pro.name AS product_name,
            pro.category AS product_cate,
            COALESCE(sin_agg.total_quantity_in, 0) AS product_stockin,
            COALESCE(sin_first.cost, 0) AS product_cost,
            COALESCE(sin_first.cost, 0) * COALESCE(sin_agg.total_quantity_in, 0) AS total_cost,
            COALESCE(ini_agg.total_quantity_out, 0) AS product_stockout,
            COALESCE(sin_first.price, 0) AS product_price,
            (COALESCE(sin_agg.total_quantity_in, 0) - COALESCE(ini_agg.total_quantity_out, 0)) AS product_available,
            COALESCE(sin_first.price, 0) * COALESCE(ini_agg.total_quantity_out, 0) AS total_revenue,
            (COALESCE(sin_first.price, 0) * COALESCE(ini_agg.total_quantity_out, 0)) - (COALESCE(sin_first.cost, 0) * COALESCE(ini_agg.total_quantity_out, 0)) AS income
        FROM
            Product pro
        LEFT JOIN LATERAL (
            SELECT
                sin.product_id,
                sin.cost,
                sin.price
            FROM
                stockin sin
            WHERE
                sin.product_id = pro.id
            LIMIT 1
        ) AS sin_first ON TRUE
        LEFT JOIN (
            SELECT
                sin.product_id,
                SUM(sin.quantity) AS total_quantity_in
            FROM
                stockin sin
            GROUP BY
                sin.product_id
        ) AS sin_agg ON pro.id = sin_agg.product_id
        LEFT JOIN (
            SELECT
                ini.product_id,
                SUM(ini.quantity) AS total_quantity_out
            FROM
                invoice_items ini
            GROUP BY
                ini.product_id
        ) AS ini_agg ON pro.id = ini_agg.product_id
        ORDER BY
            pro.id;]]></query>
	<field name="product_id" class="java.lang.Integer"/>
	<field name="product_name" class="java.lang.String"/>
	<field name="product_cate" class="java.lang.String"/>
	<field name="product_stockin" class="java.lang.Integer"/>
	<field name="product_cost" class="java.lang.Double"/>
	<field name="total_cost" class="java.lang.Double"/>
	<field name="product_stockout" class="java.lang.Integer"/>
	<field name="product_price" class="java.lang.Double"/>
	<field name="product_available" class="java.lang.Integer"/>
	<field name="total_revenue" class="java.lang.Double"/>
	<field name="income" class="java.lang.Double"/>
	<variable name="TotalIncome" calculation="Sum" class="java.lang.Double">
		<expression><![CDATA[$F{income}]]></expression>
	</variable>
	<title height="30" splitType="Stretch">
		<element kind="staticText" uuid="4615257f-57d9-41bf-b2d7-accf2174dab4" x="0" y="0" width="802" height="30" fontSize="20.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Product Inventory & Financial Report]]></text>
		</element>
	</title>
	<columnHeader height="30" splitType="Stretch">
		<element kind="staticText" uuid="f6cbec6a-e6f0-4d12-ae22-88011e5481d4" x="0" y="0" width="50" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Product ID]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="0287d77e-9223-46fe-a8dd-fc4246c2fa1d" x="50" y="0" width="90" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Product Name]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="84b031b4-5df2-4e67-8841-b6d9bd1c7d05" x="140" y="0" width="70" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Category]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="ade782ba-4e14-4c83-811d-819d50e408d2" x="210" y="0" width="70" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Stock In]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="106c9432-f6a0-4765-9982-444aecac2f89" x="280" y="0" width="70" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Unit Cost]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="74745906-1ec5-4f8b-a02d-4ce75bf21d6e" x="350" y="0" width="70" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Total Cost]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="711f4f3e-eb3e-4d61-b7f0-1ab124ac65f6" x="420" y="0" width="70" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Stock Out]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="e9ba194c-f25a-4124-9828-d81239c5b30d" x="490" y="0" width="70" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Unit Price]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="4bb7617a-7c2f-455d-a48b-75b4f8cd0535" x="560" y="0" width="70" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Available]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="848608d1-3a65-4676-a309-a9e9da467647" x="630" y="0" width="80" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Total Revenue]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="staticText" uuid="f0546090-0fff-4f4f-b7e6-440cecb970a7" x="710" y="0" width="92" height="30" backcolor="#CCCCCC" fontSize="8.0" bold="true" hTextAlign="Center" vTextAlign="Middle">
			<text><![CDATA[Income]]></text>
			<box>
				<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<element kind="textField" uuid="97e9db57-1e7a-4f3e-a4ae-708afc997534" x="0" y="0" width="50" height="20" hTextAlign="Center" vTextAlign="Middle">
				<expression><![CDATA[$F{product_id}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="6a40fc7d-cf6d-43bd-96b2-fbfb70733304" x="50" y="0" width="90" height="20" hTextAlign="Left" vTextAlign="Middle">
				<expression><![CDATA[$F{product_name}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="3e18cb9d-08f9-49ac-b65e-6c74784c7dee" x="140" y="0" width="70" height="20" hTextAlign="Left" vTextAlign="Middle">
				<expression><![CDATA[$F{product_cate}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="e525598a-1ebc-43b8-9853-7e89a5f823c3" x="210" y="0" width="70" height="20" hTextAlign="Center" vTextAlign="Middle">
				<expression><![CDATA[$F{product_stockin}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="71a5864f-260c-4b95-a259-ff48252849da" x="280" y="0" width="70" height="20" pattern="$#,##0.00" hTextAlign="Right" vTextAlign="Middle">
				<expression><![CDATA[$F{product_cost}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="d33daaa2-d6d2-4839-ba24-8c335711cadb" x="350" y="0" width="70" height="20" pattern="$#,##0.00" hTextAlign="Right" vTextAlign="Middle">
				<expression><![CDATA[$F{total_cost}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="76fe33d3-d7be-47d4-8a26-5533cc95fa00" x="420" y="0" width="70" height="20" hTextAlign="Center" vTextAlign="Middle">
				<expression><![CDATA[$F{product_stockout}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="aeeb29a0-7192-4ee6-874a-234a375a23b2" x="490" y="0" width="70" height="20" pattern="$#,##0.00" hTextAlign="Right" vTextAlign="Middle">
				<expression><![CDATA[$F{product_price}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="ce4a91ff-c83c-4d31-aff7-8a9089f8cb7c" x="560" y="0" width="70" height="20" hTextAlign="Center" vTextAlign="Middle">
				<expression><![CDATA[$F{product_available}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="f575a2e0-c7f0-4605-abad-6a808740b126" x="630" y="0" width="80" height="20" pattern="$#,##0.00" hTextAlign="Right" vTextAlign="Middle">
				<expression><![CDATA[$F{total_revenue}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
			<element kind="textField" uuid="282d76c1-4a8e-4cc0-a405-733e4f98f9d2" x="710" y="0" width="92" height="20" pattern="$#,##0.00" hTextAlign="Right" vTextAlign="Middle">
				<expression><![CDATA[$F{income}]]></expression>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
			</element>
		</band>
	</detail>
	<summary height="30">
		<element kind="staticText" uuid="6a3c68d2-84f8-46f1-880c-06136a873e83" x="560" y="0" width="150" height="30" backcolor="#D3EBFD" fontSize="13.0" bold="true" hTextAlign="Right" vTextAlign="Middle">
			<text><![CDATA[Total Income:  ]]></text>
			<box>
				<pen lineWidth="0.5"/>
				<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
		<element kind="textField" uuid="bdc76f34-0385-4890-8c7f-0f292e251b56" x="710" y="0" width="92" height="30" backcolor="#D3EBFD" fontSize="13.0" pattern="$#,##0.00" bold="true" hTextAlign="Right" vTextAlign="Middle">
			<expression><![CDATA[$V{TotalIncome}]]></expression>
			<box>
				<pen lineWidth="0.5"/>
				<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
			</box>
		</element>
	</summary>
</jasperReport>
